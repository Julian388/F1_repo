with source as (
    select * from {{ source('python_dataset', 'sprint_merged_results') }}
),

renamed as (
    select
        raceid as id,
        year,
        round,
        positiondisplayorder_qualifying as position_display_order_qualifying,
        positionnumber_qualifying as position_number_qualifying,
        positiontext_qualifying as position_text_qualifying,
        drivernumber as driver_number,
        driverid as driver_id,
        constructorid as constructor_id,
        enginemanufacturerid as engine_manufacturer_id,
        tyremanufacturerid as tyre_manufacturer_id,
        time_qualifying,
        timemillis_qualifying as time_millis_qualifying,
        q1,
        q1millis as q1_millis,
        q2,
        q2millis as q2_millis,
        q3,
        q3millis as q3_millis,
        gap_qualifying,
        gapmillis_qualifying as gap_millis_qualifying,
        interval_qualifying,
        intervalmillis_qualifying as interval_millis_qualifying,
        laps_qualifying,
        positiondisplayorder_race as position_display_order_race,
        positionnumber_race as position_number_race,
        positiontext_race as position_text_race,
        sharedcar as shared_car,
        laps_race,
        time_race,
        timemillis_race as time_millis_race,
        timepenalty as time_penalty,
        timepenaltymillis as time_penalty_millis,
        gap_race,
        gapmillis_race as gap_millis_race,
        gaplaps as gap_laps,
        interval_race,
        intervalmillis_race as interval_millis_race,
        reasonretired as reason_retired,
        points,
        poleposition as pole_position,
        qualificationpositionnumber as qualification_position_number,
        qualificationpositiontext as qualification_position_text,
        gridpositionnumber as grid_position_number,
        gridpositiontext as grid_position_text,
        positionsgained as positions_gained,
        pitstops as pit_stops,
        fastestlap as fastest_lap,
        driveroftheday as driver_of_the_day,
        grandslam as grand_slam,
        positiondisplayorder as final_position_display_order,
        positionnumber as final_position_number,
        positiontext as final_position_text,
        qualificationpositionnumber_grid as qualification_position_number_grid,
        qualificationpositiontext_grid as qualification_position_text_grid,
        gridpenalty as grid_penalty,
        gridpenaltypositions as grid_penalty_positions,
        time as final_time,
        timemillis as final_time_millis
    from source
)

select * from renamed
