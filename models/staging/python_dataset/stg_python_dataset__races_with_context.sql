with source as (
    select * from {{ source('python_dataset', 'races_with_context') }}
),

renamed as (
    select
        id as id,
        year,
        round,
        date,
        time,
        grandprixid as grand_prix_id,
        officialname as official_name,
        qualifyingformat as qualifying_format,
        sprintqualifyingformat as sprint_qualifying_format,
        circuitid as circuit_id,
        circuittype as circuit_type,
        direction,
        courselength as course_length,
        turns,
        laps,
        distance,
        scheduledlaps as scheduled_laps,
        scheduleddistance as scheduled_distance,
        driverschampionshipdecider as drivers_championship_decider,
        constructorschampionshipdecider as constructors_championship_decider,
        prequalifyingdate as pre_qualifying_date,
        prequalifyingtime as pre_qualifying_time,
        freepractice1date as free_practice_1_date,
        freepractice1time as free_practice_1_time,
        freepractice2date as free_practice_2_date,
        freepractice2time as free_practice_2_time,
        freepractice3date as free_practice_3_date,
        freepractice3time as free_practice_3_time,
        freepractice4date as free_practice_4_date,
        freepractice4time as free_practice_4_time,
        qualifying1date as qualifying_1_date,
        qualifying1time as qualifying_1_time,
        qualifying2date as qualifying_2_date,
        qualifying2time as qualifying_2_time,
        qualifyingdate as qualifying_date,
        qualifyingtime as qualifying_time,
        sprintqualifyingdate as sprint_qualifying_date,
        sprintqualifyingtime as sprint_qualifying_time,
        sprintracedate as sprint_race_date,
        sprintracetime as sprint_race_time,
        warmingupdate as warmup_date,
        warminguptime as warmup_time,
        name as circuit_name,
        fullname as circuit_full_name,
        previousnames as circuit_previous_names,
        type as circuit_type_category,
        direction_circuit,
        placename as place_name,
        countryid as country_id,
        latitude,
        longitude,
        length as circuit_length,
        turns_circuit,
        totalracesheld as total_races_held,
        alpha2code as country_code_alpha2,
        alpha3code as country_code_alpha3,
        name_country as country_name,
        demonym as country_demonym,
        continentid as continent_id,
        code as continent_code,
        name_continent as continent_name,
        demonym_continent as continent_demonym
    from source
)

select * from renamed
